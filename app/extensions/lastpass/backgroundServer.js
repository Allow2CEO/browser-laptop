BackgroundServer=function(f){LPServer.initialize(f,{ajax:function(a){LPPlatform.ajax(a)}});var e=function(a){return function(){a.apply(this,arguments);increment_local_accts_version();rewritelocalfile()}};return{identities:{add:function(a){var b=a.success;a.success=e(function(c){var d=a.params.identity;d.iid=LPServer.getAttr(c,"iid","");g_identities.push(d);b(d)});LPServer.identities.add(a)},remove:function(a){a.success=LPServer.extendCallback(a.success,e(function(){for(var b=0,c=g_identities.length;b<
c;++b)if(g_identities[b].iid===a.params.id){g_identities.splice(b,1);break}}));LPServer.identities.remove(a)},update:function(a){var b=a.success;a.success=e(function(){for(var c=a.params.identity,d=0,e=g_identities.length;d<e;++d)if(c.iid===g_identities[d].iid){g_identities[d]=c;break}b(c)});LPServer.identities.update(a)}},sharing:{individual:{shareItems:function(a){LPServer.sharing.individual.shareItems(a)},unshareItem:function(a){LPServer.sharing.individual.unshareItem(a)},acceptShare:function(a){a.success=
LPServer.extendCallback(a.success,function(){refreshsites()});LPServer.sharing.individual.acceptShare(a)},rejectShare:function(a){a.success=LPServer.extendCallback(a.success,function(){for(var b=0,c=g_pendings.length;b<c;++b)if(g_pendings[b].id===a.params.id){g_pendings.splice(b,1);break}increment_local_accts_version();rewritelocalfile()});LPServer.sharing.individual.rejectShare(a)}}}}}(this);
